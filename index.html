<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Interpretabilidade de CLASSIFICAÃ‡Ã•ES - Agnews - Redirecionando...</title>
 
  <!-- Firebase SDK ClÃ¡ssico: app e database -->
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
</head>
<body>
  <h2>Interpretabilidade de CLASSIFICAÃ‡Ã•ES - Agnews - Redirecionando...</h2>

  <script>
    var fallbackURL = "https://pt.surveymonkey.com/r/2MVRTBS";

    // âœ… ConfiguraÃ§Ã£o do Firebase
    var firebaseConfig = {
      apiKey: "AIzaSyC_ViGwQ4UfLBtCC1MzbBDJcLnlcadj0qI",
      authDomain: "follow-url-4f91a.firebaseapp.com",
      databaseURL: "https://follow-url-4f91a-default-rtdb.firebaseio.com",
      projectId: "follow-url-4f91a",
      storageBucket: "follow-url-4f91a.firebasestorage.app",
      messagingSenderId: "438011608851",
      appId: "1:438011608851:web:6acc21c954595d67d2e4e6"
    };

    // âœ… Inicializa Firebase
    firebase.initializeApp(firebaseConfig);
    var db = firebase.database();

    // âœ… Acessa os dados em 'urls'
    db.ref("urls").once("value").then(snapshot => {
      var urls = snapshot.val();
      var menor = null;
      var chaveMenor = null;

      // âœ… Encontra a URL com menor nÃºmero de acessos
      for (var chave in urls) {
        if (menor === null || urls[chave].acessos < menor) {
          menor = urls[chave].acessos;
          chaveMenor = chave;
        }
      }

      // âœ… Redireciona para a URL com menos acessos
      if (chaveMenor !== null) {
        var link = urls[chaveMenor].link;
        db.ref("urls/" + chaveMenor + "/acessos").set(menor + 1);
        window.location.href = link;
      } else {
        // ðŸ” Fallback: redireciona para a primeira URL da lista
        var chaves = Object.keys(urls);
        if (chaves.length > 0) {
          var primeiraChave = chaves[0];
          var fallbackLink = urls[primeiraChave].link;
          db.ref("urls/" + primeiraChave + "/acessos").set(urls[primeiraChave].acessos + 1);
          window.location.href = fallbackLink;
        } else {
          window.location.href = fallbackURL;
        }
      }
    }).catch(error => {
      console.error("Erro ao acessar o banco:", error);
      window.location.href = fallbackURL;
    });
  </script>
</body>
</html>
